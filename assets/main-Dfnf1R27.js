(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const a of t.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(o){if(o.ep)return;o.ep=!0;const t=i(o);fetch(o.href,t)}})();function V(e){const n=document.querySelector(".filter__tag");if(!n)return;n.querySelectorAll("button").forEach(l=>{l.addEventListener("click",o=>{o.preventDefault(),l.classList.toggle("active");const t=l.innerText.toLowerCase();if(e.labels.includes(t)){const a=e.labels.indexOf(t);a>-1&&e.labels.splice(a,1)}else e.labels.push(t);L(e)})})}async function J(e){if(document.querySelector("#challenges__container")){const l=document.querySelector(".filter__first-rate"),o=document.querySelector(".filter__second-rate"),t=l.querySelectorAll("i"),a=o.querySelectorAll("i"),u=l.querySelectorAll(".star-button"),p=o.querySelectorAll(".star-button");let m=-1,r=-1;if(t&&a){let _=function(s){m===s?(t.forEach(c=>{c.classList.remove("fa-solid"),c.classList.add("fa-regular")}),m=-1):(t.forEach((c,f)=>{s>=f?(c.classList.remove("fa-regular"),c.classList.add("fa-solid")):(c.classList.remove("fa-solid"),c.classList.add("fa-regular"))}),m=s)},g=function(s){r===s?(a.forEach(c=>{c.classList.remove("fa-solid"),c.classList.add("fa-regular")}),r=-1):(a.forEach((c,f)=>{s>=f?(c.classList.remove("fa-regular"),c.classList.add("fa-solid")):(c.classList.remove("fa-solid"),c.classList.add("fa-regular"))}),r=s)};var n=_,i=g;u.forEach((s,c)=>{s.addEventListener("click",f=>{f.preventDefault(),_(c),u.forEach((v,d)=>{v.setAttribute("aria-pressed",c===d&&c===m)}),e.minRating=s.getAttribute("aria-pressed")==="true"?c+1:0,L(e)})}),p.forEach((s,c)=>{s.addEventListener("click",f=>{f.preventDefault(),g(c),p.forEach((v,d)=>{v.setAttribute("aria-pressed",c===d&&c===r)}),e.maxRating=s.getAttribute("aria-pressed")==="true"?c+1:5,L(e)})})}}}function K(){document.querySelector(".filter__form").reset()}function z(e){const n=document.querySelector("#filter__text");n&&n.addEventListener("input",()=>{const i=n.value.toLowerCase();e.text=i,(i.length===0||i.length>=3)&&L(e)})}function G(e){const n=document.querySelector("#online-challenges"),i=document.querySelector("#on-site-challenges");n&&n.addEventListener("change",()=>{if(n.checked)e.types.includes("online")||e.types.push("online");else{const l=e.types.indexOf("online");l>-1&&e.types.splice(l,1)}L(e)}),i&&i.addEventListener("change",()=>{if(i.checked)e.types.includes("onsite")||e.types.push("onsite");else{const l=e.types.indexOf("onsite");l>-1&&e.types.splice(l,1)}L(e)})}function Q(){const e={types:[],labels:[],minRating:0,maxRating:5,text:""};G(e),V(e),J(e),z(e),K()}function L(e){const n=document.querySelectorAll(".challenges__room"),i=document.querySelector("#challenges__container");let l=i.querySelector(".filter__message");if(l||(l=document.createElement("p"),l.textContent="No matching challenges",l.classList.add("filter__message")),n.forEach(t=>{t.style.display="none"}),e.types.length===0&&e.labels.length===0&&!e.text&&e.minRating===0&&e.maxRating===5){n.forEach(t=>{t.style.display=""}),l.remove();return}const o=Array.from(n).filter(t=>{const a=t.getAttribute("id"),u=t.dataset.labels.split(","),p=t.querySelector(".room__heading").textContent.toLowerCase(),m=t.querySelector(".room__info").textContent.toLowerCase(),r=t.rating,_=e.types.length===0||e.types.includes(a),g=e.labels.length===0||e.labels.every(f=>u.includes(f)),s=!e.text||p.includes(e.text)||m.includes(e.text),c=r>=e.minRating&&r<=e.maxRating;return _&&g&&s&&c});o.length===0?i.appendChild(l):(l.remove(),o.forEach(t=>{t.style.display=""}))}const q=document.createElement("div"),A=document.createElement("div"),F=document.createElement("p"),P=document.createElement("p"),O=document.createElement("section"),N=document.createElement("h3"),k=document.createElement("input"),E=document.createElement("span"),B=document.createElement("button"),I=document.createElement("button");let b=document.createElement("p"),T=null;A.className="modal";q.className="modal__content";N.className="modal__title";F.className="modal__p-text";P.className="modal__p-date";k.className="modal__input";B.className="modal__button";I.className="modal__button_close fa fa-times";I.type="button";I.id="modal1__button_close";b.className="modal__date_error_text";N.textContent="Book room";F.textContent="What date would you like to come?";P.textContent="Date";B.textContent="Search available times";b.textContent="";k.type="date";k.setAttribute("data-date-format","YYYY MM DD");A.setAttribute("id","hidden");q.setAttribute("id","hidden");b.setAttribute("id","hidden");document.body.appendChild(O);O.appendChild(A);O.appendChild(q);q.appendChild(E);E.appendChild(N);E.appendChild(F);E.appendChild(P);E.appendChild(k);E.appendChild(B);E.appendChild(I);const D=document.querySelector(".modal__title"),w=document.querySelector(".modal__title2");let M=null;function U(){return document.querySelectorAll(".room__button--onsite").forEach(n=>{n.addEventListener("click",()=>{const i=n.closest(".challenges__room")||n.closest(".content__room");M=i.getAttribute("data-id");const o=i.querySelector(".room__heading").textContent,t=i.querySelector(".room__participants").textContent,a=document.querySelector("#participants_number"),u=parseInt(t),p=parseInt(t.split("-")[1]);A.removeAttribute("id"),q.removeAttribute("id"),N.textContent=`Book room "${o}" (step 1)`,T=o,w&&(w.className=D.className,w.textContent=D.textContent),a.innerHTML="";for(let m=u;m<=p;m++){const r=document.createElement("option");r.value=m,r.textContent=`${m} participants`,a.appendChild(r)}})}),T}function $(e){return b.textContent=e,b.style.animation="none",b.offsetWidth,b.style.animation="",b}function X(){if(!k.value){E.appendChild(b),$("No date selected"),b.removeAttribute("id");return}const e=`https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=${k.value}&challenge=${M}`;fetch(e).then(n=>{if(!n.ok)throw E.appendChild(b),$("Invalid date selected"),b.removeAttribute("id"),new Error("Network response was not ok");return n.json()}).then(n=>{const i=new CustomEvent("arrayEvent",{detail:{message:"Button clicked, sending array!",data:n.slots,id:M,title:T}});b.remove(),A.setAttribute("id","hidden"),q.setAttribute("id","hidden"),document.dispatchEvent(i),document.querySelector(".overlay").removeAttribute("id"),document.querySelector(".Bookroom_modal").removeAttribute("id")}).catch(n=>{console.error("Fetch error:",n)})}B.addEventListener("click",()=>{X()});function W(){const e=document.querySelector(".header__menu-button"),n=document.querySelector(".header__navigation-close"),i=document.querySelector(".header__navigation"),l=document.querySelector(".overlay__blur"),o=document.querySelector("#modal1__button_close"),t=document.querySelector("#modal2__button_close"),a=document.querySelector("#modal3__button_close"),u=document.querySelector(".modal"),p=document.querySelector(".modal__content"),m=document.querySelector(".Bookroom_modal"),r=document.querySelector(".modal3"),_=document.querySelector(".overlay");e.addEventListener("click",g),n.addEventListener("click",s),l.addEventListener("click",s);function g(){i.classList.add("overlay"),l.classList.add("active"),document.body.style.overflow="hidden"}function s(){i.classList.remove("overlay"),l.classList.remove("active"),document.body.style.overflow=""}o.addEventListener("click",()=>{u.setAttribute("id","hidden"),p.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()}),t.addEventListener("click",()=>{m.setAttribute("id","hidden"),_.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()}),a.addEventListener("click",()=>{r.setAttribute("id","hidden"),_.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()});function c(){const d=document.querySelector(".filter__button"),h=document.querySelector(".filter__form"),y=document.querySelector(".filter__form__close-button");d&&h&&y&&(d.addEventListener("click",S),y.addEventListener("click",C));function S(){h.style.display="block",d.style.display="none"}function C(){h.style.display="none",d.style.display=""}}c(),document.addEventListener("DOMContentLoaded",()=>{const d=u;d&&d.addEventListener("click",h),_&&_.addEventListener("click",h);function h(){const y=p;document.querySelector(".book_form").reset(),y&&(y.setAttribute("id","hidden"),d.setAttribute("id","hidden"),document.querySelector(".modal__input").value=""),m&&(m.setAttribute("id","hidden"),_.setAttribute("id","hidden"),document.querySelector(".modal__input").value=""),r&&(r.setAttribute("id","hidden"),document.querySelector(".modal__input").value="")}});const f=document.querySelectorAll(".introduction__button--online, .content__navigation-link, .introduction__button--onsite, .content__navigation-button, .play__button--book, .play__button--challenges"),v=document.querySelectorAll(".header__logo, .header__title");f.forEach(d=>{d&&d.addEventListener("click",()=>{window.location.href="./challenges.html"})}),v.forEach(d=>{d&&d.addEventListener("click",()=>{window.location.href="./index.html"})})}async function Z(){return await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()}function ee(){const e=document.querySelector("body"),n=document.createElement("div"),i=document.createElement("section"),l=document.createElement("div"),o=document.createElement("form"),t=document.createElement("h2"),a=document.createElement("label"),u=document.createElement("input"),p=document.createElement("label"),m=document.createElement("input"),r=document.createElement("label"),_=document.createElement("select"),g=document.createElement("option"),s=document.createElement("label"),c=document.createElement("select"),f=document.createElement("option"),v=document.createElement("button"),d=document.createElement("label"),h=document.createElement("input"),y=document.createElement("button");n.className="overlay",n.setAttribute("id","hidden"),i.className="Bookroom_modal",i.setAttribute("id","hidden"),l.className="book_modal",o.className="book_form",t.className="modal__title2",a.className="book_name",a.setAttribute("for","name-text"),u.type="text",u.id="name-text",p.className="book_email",p.setAttribute("for","email-text"),m.type="email",m.id="email-text",r.className="book_time",r.setAttribute("for","time_options"),_.id="time_options",s.className="book_participants",s.setAttribute("for","participants_number"),c.id="participants_number",v.className="booking_button",d.className="phone_number",d.setAttribute("for","phone-number"),h.type="tel",h.id="phone-number",y.className="modal__button_close fa fa-times",y.type="button",y.id="modal2__button_close",t.textContent="",a.textContent="Name",d.textContent="Phone number(optional)",p.textContent="Email",r.textContent="What time?",s.textContent="How many participants?",v.textContent="Submit booking",e.appendChild(n),e.appendChild(i),i.appendChild(l),l.appendChild(o),o.appendChild(t),o.appendChild(a),o.appendChild(u),o.appendChild(d),o.appendChild(h),o.appendChild(p),o.appendChild(m),o.appendChild(r),o.appendChild(_),_.appendChild(g),o.appendChild(s),o.appendChild(c),c.appendChild(f),o.appendChild(v),o.appendChild(y)}ee();const j=document.querySelector(".book_form"),te=document.querySelector(".modal__title2");let R=document.createElement("p");R.className="modal__date_error_text";let Y;function ne(e){return Y=e,e}function oe(e){return te.textContent=`Book room "${e}" (step 2)`,e}document.addEventListener("arrayEvent",e=>{const{data:n,id:i,title:l}=e.detail;let o=n;ne(i),oe(l),le(o)});j.addEventListener("submit",e=>{e.preventDefault();const n=document.getElementById("phone-number").value.trim();if(!(n===""||/^\d{10}$/.test(n)))return;const l=parseInt(Y,10),o=document.getElementById("name-text").value,t=document.getElementById("email-text").value,a=new Date().toISOString(),u=document.getElementById("time_options").value,p=document.getElementById("participants_number").value,m={challenge:l,name:o,phone:n,email:t,date:a,time:u,participants:parseInt(p,10)};fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(r=>{if(!r.ok)throw j.appendChild(R),R.textContent="All fields must be filled!",new Error("Network response was not ok");return r.json()}).then(()=>{document.querySelector(".Bookroom_modal").setAttribute("id","hidden"),document.querySelector(".modal3").removeAttribute("id")})});function le(e){const n=document.querySelector("#time_options");n.innerHTML="",e.forEach(i=>{const l=document.createElement("option");l.value=i,l.textContent=i,n.appendChild(l)})}function ie(){const e=document.createElement("section"),n=document.createElement("div"),i=document.createElement("h2"),l=document.createElement("a"),o=document.createElement("button");n.id="modal3",n.className="modal3",i.className="modalTitle",l.className="challengesLink",n.setAttribute("id","hidden"),i.textContent="Thank you!",l.textContent="Back to challenges",l.href="./challenges.html",o.className="modal__button_close fa fa-times",o.id="modal3__button_close",o.type="button",document.body.appendChild(e),e.appendChild(n),n.appendChild(i),n.appendChild(l),n.appendChild(o)}ie();function ae(){let e=document.getElementById("loadingIndicator");if(!e){const n=document.querySelector(".challenges");e=document.createElement("div"),e.id="loadingIndicator",n.appendChild(e)}e.style.display="flex"}function ce(){const e=document.getElementById("loadingIndicator");e&&setTimeout(()=>{e.style.display="none"},300)}async function H(){const n=(await Z()).challenges,i=document.querySelector("#challenges__container"),l=document.querySelector(".content__rooms");if(!i&&!l)return;let o;i?o=i:l&&(o=l,n.sort((t,a)=>a.rating-t.rating),n.length=3),o.innerHTML="",n.forEach(t=>{const a=document.createElement("div");a.classList.add(l?"content__room":"challenges__room"),a.setAttribute("data-labels",t.labels.join(",")),a.setAttribute("data-id",t.id),a.rating=t.rating,t.type==="online"?a.setAttribute("id","online"):a.setAttribute("id","onsite"),o.appendChild(a);const u=document.createElement("div");u.classList.add("room"),a.appendChild(u);const p=document.createElement("div");p.classList.add("room__image-container"),u.appendChild(p);const m=document.createElement("img");m.classList.add("room__img"),m.src=t.image,m.alt=`Picture of the room ${t.title}`,p.appendChild(m);const r=document.createElement("div");r.classList.add("room__type-icon");const _=document.createElement("i");t.type==="online"?_.classList.add("fa-solid","fa-laptop"):_.classList.add("fa-solid","fa-house"),r.appendChild(_),p.appendChild(r);const g=document.createElement("h3");g.classList.add("room__heading"),g.textContent=`${t.title} (${t.type})`,u.appendChild(g);const s=document.createElement("div");s.classList.add("room__stars"),p.appendChild(s);const c=Math.floor(t.rating),f=t.rating%1!==0,v=5-Math.ceil(t.rating);for(let C=0;C<c;C++){const x=document.createElement("i");x.classList.add("fa-solid","fa-star"),s.appendChild(x)}if(f){const C=document.createElement("i");C.classList.add("fa-solid","fa-star-half-stroke"),s.appendChild(C)}for(let C=0;C<v;C++){const x=document.createElement("i");x.classList.add("fa-regular","fa-star"),s.appendChild(x)}const d=document.createElement("p");d.classList.add("room__participants"),d.textContent=`${t.minParticipants} - ${t.maxParticipants} participants`,u.appendChild(d);const h=document.createElement("p");h.classList.add("room__info"),h.textContent=t.description,u.appendChild(h);const y=document.createElement("div");y.classList.add("challenges__actions"),u.appendChild(y);const S=document.createElement("button");S.type="button",t.type==="onsite"?(S.textContent="Book this room",S.classList.add("room__button--onsite")):t.type==="online"&&(S.textContent="Take challenge online",S.classList.add("room__button--online")),y.appendChild(S)}),U()}W();if(window.location.pathname.endsWith("/challenges.html")){W();const e=document.querySelector("#challenges__container");(e||document.querySelector(".content__rooms"))&&(ae(),setTimeout(()=>{H(),ce()},1e3)),e&&Q()}else H();
