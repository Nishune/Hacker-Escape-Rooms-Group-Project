(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(o){if(o.ep)return;o.ep=!0;const t=a(o);fetch(o.href,t)}})();function $(e){const n=document.querySelector(".filter__tag");if(!n)return;n.querySelectorAll("button").forEach(l=>{l.addEventListener("click",o=>{o.preventDefault(),l.classList.toggle("active");const t=l.innerText.toLowerCase();if(e.labels.includes(t)){const i=e.labels.indexOf(t);i>-1&&e.labels.splice(i,1)}else e.labels.push(t);L(e)})})}async function H(e){if(document.querySelector("#challenges__container")){const l=document.querySelector(".filter__first-rate"),o=document.querySelector(".filter__second-rate"),t=l.querySelectorAll("i"),i=o.querySelectorAll("i"),u=l.querySelectorAll(".star-button"),p=o.querySelectorAll(".star-button");let m=-1,d=-1;if(t&&i){let r=function(c){m===c?(t.forEach(s=>{s.classList.remove("fa-solid"),s.classList.add("fa-regular")}),m=-1):(t.forEach((s,h)=>{c>=h?(s.classList.remove("fa-regular"),s.classList.add("fa-solid")):(s.classList.remove("fa-solid"),s.classList.add("fa-regular"))}),m=c)},f=function(c){d===c?(i.forEach(s=>{s.classList.remove("fa-solid"),s.classList.add("fa-regular")}),d=-1):(i.forEach((s,h)=>{c>=h?(s.classList.remove("fa-regular"),s.classList.add("fa-solid")):(s.classList.remove("fa-solid"),s.classList.add("fa-regular"))}),d=c)};var n=r,a=f;u.forEach((c,s)=>{c.addEventListener("click",h=>{h.preventDefault(),r(s),u.forEach((b,y)=>{b.setAttribute("aria-pressed",s===y&&s===m)}),e.minRating=c.getAttribute("aria-pressed")==="true"?s+1:0,L(e)})}),p.forEach((c,s)=>{c.addEventListener("click",h=>{h.preventDefault(),f(s),p.forEach((b,y)=>{b.setAttribute("aria-pressed",s===y&&s===d)}),e.maxRating=c.getAttribute("aria-pressed")==="true"?s+1:5,L(e)})})}}}function Y(){document.querySelector(".filter__form").reset()}function W(e){const n=document.querySelector("#filter__text");n&&n.addEventListener("input",()=>{const a=n.value.toLowerCase();e.text=a,(a.length===0||a.length>=3)&&L(e)})}function V(e){const n=document.querySelector("#online-challenges"),a=document.querySelector("#on-site-challenges");n&&n.addEventListener("change",()=>{if(n.checked)e.types.includes("online")||e.types.push("online");else{const l=e.types.indexOf("online");l>-1&&e.types.splice(l,1)}L(e)}),a&&a.addEventListener("change",()=>{if(a.checked)e.types.includes("onsite")||e.types.push("onsite");else{const l=e.types.indexOf("onsite");l>-1&&e.types.splice(l,1)}L(e)})}function J(){const e={types:[],labels:[],minRating:0,maxRating:5,text:""};V(e),$(e),H(e),W(e),Y()}function L(e){const n=document.querySelectorAll(".challenges__room"),a=document.querySelector("#challenges__container");let l=a.querySelector(".filter__message");if(l||(l=document.createElement("p"),l.textContent="No matching challenges",l.classList.add("filter__message")),n.forEach(t=>{t.style.display="none"}),e.types.length===0&&e.labels.length===0&&!e.text&&e.minRating===0&&e.maxRating===5){n.forEach(t=>{t.style.display=""}),l.remove();return}const o=Array.from(n).filter(t=>{const i=t.getAttribute("id"),u=t.dataset.labels.split(","),p=t.querySelector(".room__heading").textContent.toLowerCase(),m=t.querySelector(".room__info").textContent.toLowerCase(),d=t.rating,r=e.types.length===0||e.types.includes(i),f=e.labels.length===0||e.labels.every(h=>u.includes(h)),c=!e.text||p.includes(e.text)||m.includes(e.text),s=d>=e.minRating&&d<=e.maxRating;return r&&f&&c&&s});o.length===0?a.appendChild(l):(l.remove(),o.forEach(t=>{t.style.display=""}))}const T=document.createElement("div"),k=document.createElement("div"),M=document.createElement("p"),R=document.createElement("p"),O=document.createElement("section"),q=document.createElement("h3"),S=document.createElement("input"),g=document.createElement("span"),A=document.createElement("button"),D=document.createElement("button");let _=document.createElement("p"),w=null;k.className="modal";T.className="modal__content";q.className="modal__title";M.className="modal__p-text";R.className="modal__p-date";S.className="modal__input";A.className="modal__button";D.className="modal__button_close";_.className="modal__date_error_text";q.textContent="Book room";M.textContent="What date would you like to come?";R.textContent="Date";A.textContent="Search available times";_.textContent="";S.type="date";S.setAttribute("data-date-format","YYYY MM DD");k.setAttribute("id","hidden");_.setAttribute("id","hidden");document.body.appendChild(O);O.appendChild(k);k.appendChild(T);T.appendChild(g);g.appendChild(q);g.appendChild(M);g.appendChild(R);g.appendChild(S);g.appendChild(A);g.appendChild(D);const F=document.querySelector(".modal__title"),B=document.querySelector(".modal__title2");let I=null;function K(){return document.querySelectorAll(".room__button--onsite").forEach(n=>{n.addEventListener("click",()=>{const a=n.closest(".challenges__room")||n.closest(".content__room");I=a.getAttribute("data-id");const o=a.querySelector(".room__heading").textContent,t=a.querySelector(".room__participants").textContent,i=document.querySelector("#participants_number"),u=parseInt(t),p=parseInt(t.split("-")[1]);k.removeAttribute("id"),q.textContent=`Book room "${o}" (step 1)`,w=o,B&&(B.className=F.className,B.textContent=F.textContent),i.innerHTML="";for(let m=u;m<=p;m++){const d=document.createElement("option");d.value=m,d.textContent=`${m} participants`,i.appendChild(d)}})}),w}function P(e){return _.textContent=e,_.style.animation="none",_.offsetWidth,_.style.animation="",_}function z(){if(!S.value){g.appendChild(_),P("No date selected"),_.removeAttribute("id");return}const e=`https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=${S.value}&challenge=${I}`;fetch(e).then(n=>{if(!n.ok)throw g.appendChild(_),P("Invalid date selected"),_.removeAttribute("id"),new Error("Network response was not ok");return n.json()}).then(n=>{const a=new CustomEvent("arrayEvent",{detail:{message:"Button clicked, sending array!",data:n.slots,id:I,title:w}});_.remove(),k.setAttribute("id","hidden"),document.dispatchEvent(a),document.querySelector(".overlay").style.display="initial",document.querySelector(".Bookroom_modal").style.display="flex"}).catch(n=>{console.error("Fetch error:",n)})}A.addEventListener("click",()=>{z()});function G(){const e=document.querySelector(".header__menu-button"),n=document.querySelector(".header__navigation-close"),a=document.querySelector(".header__navigation"),l=document.querySelector(".overlay__blur"),o=document.querySelector(".modal__button_close"),t=document.querySelector(".modal");e.addEventListener("click",i),n.addEventListener("click",u),l.addEventListener("click",u);function i(){a.classList.add("overlay"),l.classList.add("active"),document.body.style.overflow="hidden"}function u(){a.classList.remove("overlay"),l.classList.remove("active"),document.body.style.overflow=""}o.addEventListener("click",()=>{t.setAttribute("id","hidden")});function p(){const r=document.querySelector(".filter__button"),f=document.querySelector(".filter__form"),c=document.querySelector(".filter__form__close-button");r&&f&&c&&(r.addEventListener("click",s),c.addEventListener("click",h));function s(){f.style.display="block",r.style.display="none"}function h(){f.style.display="none",r.style.display=""}}p(),document.addEventListener("DOMContentLoaded",()=>{const r=document.querySelector(".overlay");r&&r.addEventListener("click",f);function f(){const c=document.querySelector(".Bookroom_modal");c&&(c.style.display="none"),r.style.display="none"}});const m=document.querySelectorAll(".introduction__button--online, .content__navigation-link, .introduction__button--onsite, .content__navigation-button, .play__button--book, .play__button--challenges"),d=document.querySelectorAll(".header__logo, .header__title");m.forEach(r=>{r&&r.addEventListener("click",()=>{window.location.href="./challenges.html"})}),d.forEach(r=>{r&&r.addEventListener("click",()=>{window.location.href="./index.html"})})}async function Q(){return await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()}function U(){const e=document.querySelector("body"),n=document.createElement("div"),a=document.createElement("section"),l=document.createElement("div"),o=document.createElement("form"),t=document.createElement("h2"),i=document.createElement("label"),u=document.createElement("input"),p=document.createElement("label"),m=document.createElement("input"),d=document.createElement("label"),r=document.createElement("select"),f=document.createElement("option"),c=document.createElement("label"),s=document.createElement("select"),h=document.createElement("option"),b=document.createElement("button"),y=document.createElement("label"),C=document.createElement("input");n.className="overlay",n.setAttribute("id","hidden"),a.className="Bookroom_modal",a.setAttribute("id","hidden"),l.className="book_modal",o.className="book_form",t.className="modal__title2",i.className="book_name",i.setAttribute("for","name-text"),u.type="text",u.id="name-text",p.className="book_email",p.setAttribute("for","email-text"),m.type="email",m.id="email-text",d.className="book_time",d.setAttribute("for","time_options"),r.id="time_options",c.className="book_participants",c.setAttribute("for","participants_number"),s.id="participants_number",b.className="booking_button",y.className="phone_number",y.setAttribute("for","phone-number"),C.type="tel",C.id="phone-number",t.textContent="",i.textContent="Name",y.textContent="Phone number(optional)",p.textContent="Email",d.textContent="What time?",c.textContent="How many participants?",b.textContent="Submit booking",e.appendChild(n),e.appendChild(a),a.appendChild(l),l.appendChild(o),o.appendChild(t),o.appendChild(i),o.appendChild(u),o.appendChild(y),o.appendChild(C),o.appendChild(p),o.appendChild(m),o.appendChild(d),o.appendChild(r),r.appendChild(f),o.appendChild(c),o.appendChild(s),s.appendChild(h),o.appendChild(b)}U();const X=document.querySelector(".book_form"),Z=document.querySelector(".modal__title2");let j;function ee(e){return j=e,e}function te(e){return Z.textContent=`Book room "${e}" (step 2)`,e}document.addEventListener("arrayEvent",e=>{const{data:n,id:a,title:l}=e.detail;let o=n;ee(a),te(l),ne(o)});X.addEventListener("submit",e=>{e.preventDefault();const n=document.getElementById("phone-number").value.trim();if(!(n===""||/^\d{10}$/.test(n)))return;const l=parseInt(j,10),o=document.getElementById("name-text").value,t=document.getElementById("email-text").value,i=new Date().toISOString(),u=document.getElementById("time_options").value,p=document.getElementById("participants_number").value,m={challenge:l,name:o,phone:n,email:t,date:i,time:u,participants:parseInt(p,10)};fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)}).then(d=>{if(!d.ok)throw alert("All fields must be filled!"),new Error("Network response was not ok");return d.json()}).then(()=>{document.querySelector(".modal3").removeAttribute("id")})});function ne(e){const n=document.querySelector("#time_options");n.innerHTML="",e.forEach(a=>{const l=document.createElement("option");l.value=a,l.textContent=a,n.appendChild(l)})}function oe(){const e=document.createElement("section"),n=document.createElement("div"),a=document.createElement("h2"),l=document.createElement("a");n.id="modal3",n.className="modal3",a.className="modalTitle",l.className="challengesLink",n.setAttribute("id","hidden"),a.textContent="Thank you!",l.textContent="Back to challenges",l.href="./challenges.html",document.body.appendChild(e),e.appendChild(n),n.appendChild(a),n.appendChild(l)}oe();async function le(){const n=(await Q()).challenges,a=document.querySelector("#challenges__container"),l=document.querySelector(".content__rooms");let o;a?o=a:l&&(o=l,n.sort((t,i)=>i.rating-t.rating),n.length=3),o.innerHTML="",n.forEach(t=>{const i=document.createElement("div");i.classList.add(l?"content__room":"challenges__room"),i.setAttribute("data-labels",t.labels.join(",")),i.setAttribute("data-id",t.id),i.rating=t.rating,t.type==="online"?i.setAttribute("id","online"):i.setAttribute("id","onsite"),o.appendChild(i);const u=document.createElement("div");u.classList.add("room"),i.appendChild(u);const p=document.createElement("div");p.classList.add("room__image-container"),u.appendChild(p);const m=document.createElement("img");m.classList.add("room__img"),m.src=t.image,m.alt=`Picture of the room ${t.title}`,p.appendChild(m);const d=document.createElement("div");d.classList.add("room__type-icon");const r=document.createElement("i");t.type==="online"?r.classList.add("fa-solid","fa-laptop"):r.classList.add("fa-solid","fa-house"),d.appendChild(r),p.appendChild(d);const f=document.createElement("h3");f.classList.add("room__heading"),f.textContent=`${t.title} (${t.type})`,u.appendChild(f);const c=document.createElement("div");c.classList.add("room__stars"),p.appendChild(c);const s=Math.floor(t.rating),h=t.rating%1!==0,b=5-Math.ceil(t.rating);for(let E=0;E<s;E++){const x=document.createElement("i");x.classList.add("fa-solid","fa-star"),c.appendChild(x)}if(h){const E=document.createElement("i");E.classList.add("fa-solid","fa-star-half-stroke"),c.appendChild(E)}for(let E=0;E<b;E++){const x=document.createElement("i");x.classList.add("fa-regular","fa-star"),c.appendChild(x)}const y=document.createElement("p");y.classList.add("room__participants"),y.textContent=`${t.minParticipants} - ${t.maxParticipants} participants`,u.appendChild(y);const C=document.createElement("p");C.classList.add("room__info"),C.textContent=t.description,u.appendChild(C);const N=document.createElement("div");N.classList.add("challenges__actions"),u.appendChild(N);const v=document.createElement("button");v.type="button",t.type==="onsite"?(v.textContent="Book this room",v.classList.add("room__button--onsite")):t.type==="online"&&(v.textContent="Take challenge online",v.classList.add("room__button--online")),N.appendChild(v)}),K()}G();(document.querySelector("#challenges__container")||document.querySelector(".content__rooms"))&&le();document.querySelector("#challenges__container")&&J();
