(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();function J(e){const t=document.querySelector(".filter__tag");if(!t)return;t.querySelectorAll("button").forEach(l=>{l.addEventListener("click",o=>{o.preventDefault(),l.classList.toggle("active");const n=l.innerText.toLowerCase();if(e.labels.includes(n)){const s=e.labels.indexOf(n);s>-1&&e.labels.splice(s,1)}else e.labels.push(n);L(e)})})}async function K(e){if(document.querySelector("#challenges__container")){const l=document.querySelector(".filter__first-rate"),o=document.querySelector(".filter__second-rate"),n=l.querySelectorAll("i"),s=o.querySelectorAll("i"),u=l.querySelectorAll(".star-button"),p=o.querySelectorAll(".star-button");let r=-1,c=-1;if(n&&s){let f=function(d){r===d?(n.forEach(i=>{i.classList.remove("fa-solid"),i.classList.add("fa-regular")}),r=-1):(n.forEach((i,_)=>{d>=_?(i.classList.remove("fa-regular"),i.classList.add("fa-solid")):(i.classList.remove("fa-solid"),i.classList.add("fa-regular"))}),r=d)},g=function(d){c===d?(s.forEach(i=>{i.classList.remove("fa-solid"),i.classList.add("fa-regular")}),c=-1):(s.forEach((i,_)=>{d>=_?(i.classList.remove("fa-regular"),i.classList.add("fa-solid")):(i.classList.remove("fa-solid"),i.classList.add("fa-regular"))}),c=d)};var t=f,a=g;u.forEach((d,i)=>{d.addEventListener("click",_=>{_.preventDefault(),f(i),u.forEach((v,m)=>{v.setAttribute("aria-pressed",i===m&&i===r)}),e.minRating=d.getAttribute("aria-pressed")==="true"?i+1:0,L(e)})}),p.forEach((d,i)=>{d.addEventListener("click",_=>{_.preventDefault(),g(i),p.forEach((v,m)=>{v.setAttribute("aria-pressed",i===m&&i===c)}),e.maxRating=d.getAttribute("aria-pressed")==="true"?i+1:5,L(e)})})}}}function z(){document.querySelector(".filter__form").reset()}function G(e){const t=document.querySelector("#filter__text");t&&t.addEventListener("input",()=>{const a=t.value.toLowerCase();e.text=a,(a.length===0||a.length>=3)&&L(e)})}function Q(e){const t=document.querySelector("#online-challenges"),a=document.querySelector("#on-site-challenges");t&&t.addEventListener("change",()=>{if(t.checked)e.types.includes("online")||e.types.push("online");else{const l=e.types.indexOf("online");l>-1&&e.types.splice(l,1)}L(e)}),a&&a.addEventListener("change",()=>{if(a.checked)e.types.includes("onsite")||e.types.push("onsite");else{const l=e.types.indexOf("onsite");l>-1&&e.types.splice(l,1)}L(e)})}function U(){const e={types:[],labels:[],minRating:0,maxRating:5,text:""};Q(e),J(e),K(e),G(e),z()}function L(e){const t=document.querySelectorAll(".challenges__room"),a=document.querySelector("#challenges__container");let l=a.querySelector(".filter__message");if(l||(l=document.createElement("p"),l.textContent="No matching challenges",l.classList.add("filter__message")),t.forEach(n=>{n.style.display="none"}),e.types.length===0&&e.labels.length===0&&!e.text&&e.minRating===0&&e.maxRating===5){t.forEach(n=>{n.style.display=""}),l.remove();return}const o=Array.from(t).filter(n=>{const s=n.getAttribute("id"),u=n.dataset.labels.split(","),p=n.querySelector(".room__heading").textContent.toLowerCase(),r=n.querySelector(".room__info").textContent.toLowerCase(),c=n.rating,f=e.types.length===0||e.types.includes(s),g=e.labels.length===0||e.labels.every(_=>u.includes(_)),d=!e.text||p.includes(e.text)||r.includes(e.text),i=c>=e.minRating&&c<=e.maxRating;return f&&g&&d&&i});o.length===0?a.appendChild(l):(l.remove(),o.forEach(n=>{n.style.display=""}))}const q=document.createElement("div"),N=document.createElement("div"),O=document.createElement("p"),P=document.createElement("p"),D=document.createElement("section"),B=document.createElement("h3"),k=document.createElement("input"),C=document.createElement("span"),I=document.createElement("button"),w=document.createElement("button");let b=document.createElement("p"),M=null;N.className="modal";q.className="modal__content";B.className="modal__title";O.className="modal__p-text";P.className="modal__p-date";k.className="modal__input";I.className="modal__button";w.className="modal__button_close fa fa-times";w.type="button";w.id="modal1__button_close";b.className="modal__date_error_text";B.textContent="Book room";O.textContent="What date would you like to come?";P.textContent="Date";I.textContent="Search available times";b.textContent="";k.type="date";k.setAttribute("data-date-format","YYYY MM DD");N.setAttribute("id","hidden");q.setAttribute("id","hidden");b.setAttribute("id","hidden");document.body.appendChild(D);D.appendChild(N);D.appendChild(q);q.appendChild(C);C.appendChild(B);C.appendChild(O);C.appendChild(P);C.appendChild(k);C.appendChild(I);C.appendChild(w);const $=document.querySelector(".modal__title"),T=document.querySelector(".modal__title2");let R=null;function X(){return document.querySelectorAll(".room__button--onsite").forEach(t=>{t.addEventListener("click",()=>{const a=t.closest(".challenges__room")||t.closest(".content__room");R=a.getAttribute("data-id");const o=a.querySelector(".room__heading").textContent,n=a.querySelector(".room__participants").textContent,s=document.querySelector("#participants_number"),u=parseInt(n),p=parseInt(n.split("-")[1]);N.removeAttribute("id"),q.removeAttribute("id"),B.textContent=`Book room "${o}" (step 1)`,M=o,T&&(T.className=$.className,T.textContent=$.textContent),s.innerHTML="";for(let r=u;r<=p;r++){const c=document.createElement("option");c.value=r,c.textContent=`${r} participants`,s.appendChild(c)}})}),M}function j(e){return b.textContent=e,b.style.animation="none",b.offsetWidth,b.style.animation="",b}function Z(){if(!k.value){C.appendChild(b),j("No date selected"),b.removeAttribute("id");return}const e=`https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=${k.value}&challenge=${R}`;fetch(e).then(t=>{if(!t.ok)throw C.appendChild(b),j("Invalid date selected"),b.removeAttribute("id"),new Error("Network response was not ok");return t.json()}).then(t=>{const a=new CustomEvent("arrayEvent",{detail:{message:"Button clicked, sending array!",data:t.slots,id:R,title:M}});b.remove(),N.setAttribute("id","hidden"),q.setAttribute("id","hidden"),document.dispatchEvent(a),document.querySelector(".overlay").removeAttribute("id"),document.querySelector(".Bookroom_modal").removeAttribute("id")}).catch(t=>{console.error("Fetch error:",t)})}I.addEventListener("click",()=>{Z()});function Y(){const e=document.querySelector(".header__menu-button"),t=document.querySelector(".header__navigation-close"),a=document.querySelector(".header__navigation"),l=document.querySelector(".overlay__blur"),o=document.querySelector("#modal1__button_close"),n=document.querySelector("#modal2__button_close"),s=document.querySelector("#modal3__button_close"),u=document.querySelector(".modal"),p=document.querySelector(".modal__content"),r=document.querySelector(".Bookroom_modal"),c=document.querySelector(".modal3"),f=document.querySelector(".overlay");e.addEventListener("click",g),t.addEventListener("click",d),l.addEventListener("click",d);function g(){a.classList.add("overlay"),l.classList.add("active"),document.body.style.overflow="hidden"}function d(){a.classList.remove("overlay"),l.classList.remove("active"),document.body.style.overflow=""}o.addEventListener("click",()=>{u.setAttribute("id","hidden"),p.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()}),n.addEventListener("click",()=>{r.setAttribute("id","hidden"),f.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()}),s.addEventListener("click",()=>{c.setAttribute("id","hidden"),f.setAttribute("id","hidden"),document.querySelector(".modal__input").value="",document.querySelector(".book_form").reset()});function i(){const m=document.querySelector(".filter__button"),h=document.querySelector(".filter__form"),y=document.querySelector(".filter__form__close-button");m&&h&&y&&(m.addEventListener("click",x),y.addEventListener("click",E));function x(){h.style.display="block",m.style.display="none"}function E(){h.style.display="none",m.style.display=""}}i(),document.addEventListener("DOMContentLoaded",()=>{const m=u;m&&m.addEventListener("click",h),f&&f.addEventListener("click",h);function h(){const y=p;document.querySelector(".book_form").reset(),y&&(y.setAttribute("id","hidden"),m.setAttribute("id","hidden"),document.querySelector(".modal__input").value=""),r&&(r.setAttribute("id","hidden"),f.setAttribute("id","hidden"),document.querySelector(".modal__input").value=""),c&&(c.setAttribute("id","hidden"),document.querySelector(".modal__input").value="")}});const _=document.querySelectorAll(".introduction__button--online, .content__navigation-link, .introduction__button--onsite, .content__navigation-button, .play__button--book, .play__button--challenges"),v=document.querySelectorAll(".header__logo, .header__title");_.forEach(m=>{m&&m.addEventListener("click",()=>{window.location.href="./challenges.html"})}),v.forEach(m=>{m&&m.addEventListener("click",()=>{window.location.href="./index.html"})})}async function ee(){return await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()}function te(){const e=document.querySelector("body"),t=document.createElement("div"),a=document.createElement("section"),l=document.createElement("div"),o=document.createElement("form"),n=document.createElement("h2"),s=document.createElement("label"),u=document.createElement("input"),p=document.createElement("label"),r=document.createElement("input"),c=document.createElement("label"),f=document.createElement("select"),g=document.createElement("option"),d=document.createElement("label"),i=document.createElement("select"),_=document.createElement("option"),v=document.createElement("button"),m=document.createElement("label"),h=document.createElement("input"),y=document.createElement("button");t.className="overlay",t.setAttribute("id","hidden"),a.className="Bookroom_modal",a.setAttribute("id","hidden"),l.className="book_modal",o.className="book_form",n.className="modal__title2",s.className="book_name",s.setAttribute("for","name-text"),u.type="text",u.id="name-text",p.className="book_email",p.setAttribute("for","email-text"),r.type="email",r.id="email-text",c.className="book_time",c.setAttribute("for","time_options"),f.id="time_options",d.className="book_participants",d.setAttribute("for","participants_number"),i.id="participants_number",v.className="booking_button",m.className="phone_number",m.setAttribute("for","phone-number"),h.type="tel",h.id="phone-number",y.className="modal__button_close fa fa-times",y.type="button",y.id="modal2__button_close",n.textContent="",s.textContent="Name",m.textContent="Phone number(optional)",p.textContent="Email",c.textContent="What time?",d.textContent="How many participants?",v.textContent="Submit booking",e.appendChild(t),e.appendChild(a),a.appendChild(l),l.appendChild(o),o.appendChild(n),o.appendChild(s),o.appendChild(u),o.appendChild(m),o.appendChild(h),o.appendChild(p),o.appendChild(r),o.appendChild(c),o.appendChild(f),f.appendChild(g),o.appendChild(d),o.appendChild(i),i.appendChild(_),o.appendChild(v),o.appendChild(y)}te();const H=document.querySelector(".book_form"),ne=document.querySelector(".modal__title2");let F=document.createElement("p");F.className="modal__date_error_text";let V;function oe(e){return V=e,e}function le(e){return ne.textContent=`Book room "${e}" (step 2)`,e}document.addEventListener("arrayEvent",e=>{const{data:t,id:a,title:l}=e.detail;let o=t;oe(a),le(l),ae(o)});H.addEventListener("submit",e=>{e.preventDefault();const t=document.getElementById("phone-number").value.trim();if(!(t===""||/^\d{10}$/.test(t)))return;const l=parseInt(V,10),o=document.getElementById("name-text").value,n=document.getElementById("email-text").value,s=new Date().toISOString(),u=document.getElementById("time_options").value,p=document.getElementById("participants_number").value,r={challenge:l,name:o,phone:t,email:n,date:s,time:u,participants:parseInt(p,10)};fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then(c=>{if(!c.ok)throw H.appendChild(F),F.textContent="All fields must be filled!",new Error("Network response was not ok");return c.json()}).then(()=>{document.querySelector(".Bookroom_modal").setAttribute("id","hidden"),document.querySelector(".modal3").removeAttribute("id")})});function ae(e){const t=document.querySelector("#time_options");t.innerHTML="",e.forEach(a=>{const l=document.createElement("option");l.value=a,l.textContent=a,t.appendChild(l)})}function ie(){const e=document.createElement("section"),t=document.createElement("div"),a=document.createElement("h2"),l=document.createElement("a"),o=document.createElement("button");t.id="modal3",t.className="modal3",a.className="modalTitle",l.className="challengesLink",t.setAttribute("id","hidden"),a.textContent="Thank you!",l.textContent="Back to challenges",l.href="./challenges.html",o.className="modal__button_close fa fa-times",o.id="modal3__button_close",o.type="button",document.body.appendChild(e),e.appendChild(t),t.appendChild(a),t.appendChild(l),t.appendChild(o)}ie();document.addEventListener("DOMContentLoaded",()=>{});function ce(){let e=document.getElementById("loadingIndicator");if(!e){const t=document.querySelector(".challenges");e=document.createElement("div"),e.id="loadingIndicator",t.appendChild(e)}e.style.display="flex"}function se(){const e=document.getElementById("loadingIndicator");e&&(e.style.display="none")}async function W(){const t=(await ee()).challenges,a=document.querySelector("#challenges__container"),l=document.querySelector(".content__rooms");if(!a&&!l)return;let o;a?o=a:l&&(o=l,t.sort((n,s)=>s.rating-n.rating),t.length=3),o.innerHTML="",t.forEach((n,s)=>{const u=document.createElement("div");u.classList.add(l?"content__room":"challenges__room"),u.setAttribute("data-labels",n.labels.join(",")),u.setAttribute("data-id",n.id),u.rating=n.rating,n.type==="online"?u.setAttribute("id","online"):u.setAttribute("id","onsite"),o.appendChild(u);const p=document.createElement("div");p.classList.add("room"),u.appendChild(p);const r=document.createElement("div");r.classList.add("room__image-container"),p.appendChild(r);const c=document.createElement("img");c.classList.add("room__img"),c.src=n.image,c.alt=`Picture of the room ${n.title}`,r.appendChild(c);const f=document.createElement("div");f.classList.add("room__type-icon");const g=document.createElement("i");n.type==="online"?g.classList.add("fa-solid","fa-laptop"):g.classList.add("fa-solid","fa-house"),f.appendChild(g),r.appendChild(f);const d=document.createElement("h1");d.classList.add("room__heading"),d.textContent=`${n.title} (${n.type})`,p.appendChild(d);const i=document.createElement("div");i.classList.add("room__stars"),r.appendChild(i);const _=Math.floor(n.rating),v=n.rating%1!==0,m=5-Math.ceil(n.rating);for(let S=0;S<_;S++){const A=document.createElement("i");A.classList.add("fa-solid","fa-star"),i.appendChild(A)}if(v){const S=document.createElement("i");S.classList.add("fa-solid","fa-star-half-stroke"),i.appendChild(S)}for(let S=0;S<m;S++){const A=document.createElement("i");A.classList.add("fa-regular","fa-star"),i.appendChild(A)}const h=document.createElement("p");h.classList.add("room__participants"),h.textContent=`${n.minParticipants} - ${n.maxParticipants} participants`,p.appendChild(h);const y=document.createElement("p");y.classList.add("room__info"),y.textContent=n.description,p.appendChild(y);const x=document.createElement("div");x.classList.add("challenges__actions"),p.appendChild(x);const E=document.createElement("button");E.type="button",n.type==="onsite"?(E.textContent="Book this room",E.classList.add("room__button--onsite")):n.type==="online"&&(E.textContent="Take challenge online",E.classList.add("room__button--online")),x.appendChild(E)}),X()}Y();(async()=>{if(window.location.pathname.endsWith("/challenges.html")){Y();const e=document.querySelector("#challenges__container");if(e||document.querySelector(".content__rooms"))try{ce(),await W()}catch(t){console.error("Error:",t)}finally{se()}e&&U()}else await W()})();
